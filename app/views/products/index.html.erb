<% provide(:title, "All Products") %> 
<h1>All Products</h1>

<% if can? :manage, @product %>
  <p><%= link_to 'add new Product', new_product_path %></p>
  <div>
    <%= form_tag import_products_path, multipart: true do %>
      <%= file_field_tag :file %>
        <%= submit_tag "Import Products" %>
    <% end %>
  </div>
  <p>download list as: <%= link_to ".csv", products_path(format: "csv") %></p>
<% end %>

<table id="products" class="table table-striped table-bordered">
  <tr>
    <% if can? :manage, @product %>
      <th>(admin)</th>
    <% end %>
    <th>Item Number</th>
    <th>Description</th>
    <th>Category</th>
    <th>Retail Price</th>
    <th>CPO</th>
    <th>Point Value</th>
  </tr>
  <% @products.sort_by(&:position).each do |product| %>
    <%= render 'product', product: product %>
  <% end %>
</table>